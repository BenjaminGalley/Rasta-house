<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RASTA ADMIN | MASTER</title>
    <style>
        :root { --green: #008542; --gold: #FFD100; --red: #E71D36; }
        body { background: #000; color: white; font-family: sans-serif; padding: 15px; }
        .card { background: #111; padding: 15px; border-radius: 12px; margin-bottom: 20px; border: 1px solid #333; }
        .dep-card { border-left: 6px solid var(--green); }
        .wit-card { border-left: 6px solid var(--red); }
        .label { color: #888; font-size: 0.75rem; display: block; margin-top: 8px; }
        .val { color: var(--gold); font-weight: bold; font-size: 1rem; }
        .amt { font-size: 1.6rem; font-weight: bold; margin: 10px 0; color: white; }
        .btn { width: 100%; padding: 15px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .btn-app { background: var(--green); color: white; }
        .btn-pay { background: var(--gold); color: black; }
    </style>
</head>
<body>

    <h2 style="color:var(--gold); text-align:center;">RASTA ADMIN PANEL</h2>

    <h3 style="color:var(--green)">üì• DEPOSIT REQUESTS (·åà·äï·ãò·â• ·åà·â¢)</h3>
    <div id="dep-list">Fetching...</div>

    <h3 style="color:var(--red); margin-top:40px;">üì§ WITHDRAWAL REQUESTS (·åà·äï·ãò·â• ·ãà·å™)</h3>
    <div id="wit-list">Fetching...</div>

    <script>
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzdPewsjld31mT1oBLhtCk_bkM5B_iVcaOeTMJUFMPxqgyH2bFJVYZIFTcZrPgxBrID/exec";

        async function load() {
            const res = await fetch(`${SCRIPT_URL}?action=getAdminData`);
            const data = await res.json();

            let dHtml = '';
            data.deposits.forEach(d => {
                dHtml += `<div class="card dep-card">
                    <span class="label">SENDER NAME (·ä®·àõ·äï ·ã®·â∞·àã·ä®):</span> <span class="val">${d.fromName}</span>
                    <span class="label">SENDER PHONE (·ã®·àã·ä™ ·àµ·àç·ä≠):</span> <span class="val">${d.fromPhone}</span>
                    <span class="label">METHOD & TXN ID:</span> <span class="val">${d.method} | ${d.txnID}</span>
                    <div class="amt">${d.amount} ETB</div>
                    <button class="btn btn-app" onclick="action('approveDeposit','${d.id}')">APPROVE DEPOSIT ‚úÖ</button>
                </div>`;
            });
            document.getElementById('dep-list').innerHTML = dHtml || "No pending deposits";

            let wHtml = '';
            data.withdrawals.forEach(w => {
                wHtml += `<div class="card wit-card">
                    <span class="label">RECEIVER NAME (·ã®·â∞·âÄ·â£·ã≠ ·àµ·àù):</span> <span class="val">${w.toName}</span>
                    <span class="label">SEND TO (·ã≠·àã·ä© ·ãà·ã∞):</span> <span class="val" style="font-size:1.2rem; color:white;">${w.toPhone} (${w.method})</span>
                    <div class="amt" style="color:var(--red)">${w.amount} ETB</div>
                    <button class="btn btn-pay" onclick="confirm('Sent ${w.amount} to ${w.toPhone}?') && action('approveWithdrawal','${w.id}')">MARK AS PAID üí∏</button>
                </div>`;
            });
            document.getElementById('wit-list').innerHTML = wHtml || "No pending withdrawals";
        }

        async function action(type, id) {
            await fetch(`${SCRIPT_URL}?action=${type}&id=${id}`);
            alert("Updated!"); load();
        }
        window.onload = load;
    </script>
</body>
</html>

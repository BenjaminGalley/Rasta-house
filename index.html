<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RASTA HOUSE | LOBBY - WIN BIG</title>
    <link href="https://fonts.googleapis.com/css2?family=Goldman&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { 
            --rasta-green: #008542; 
            --rasta-gold: #FFD100; 
            --rasta-red: #E71D36; 
            --dark-bg: #0a0a0a; 
            --glass: rgba(255, 255, 255, 0.05);
            --card-shadow: 0 10px 20px rgba(0,0,0,0.5);
        }
        
        body { 
            background: var(--dark-bg); 
            color: white; 
            font-family: 'Goldman', 'Segoe UI', Roboto, sans-serif; 
            margin: 0; 
            padding-bottom: 90px; 
            overflow-x: hidden; 
        }
        
        /* --- SIDE MENU STYLES --- */
        .sidebar {
            position: fixed; top: 0; left: -300px; width: 280px; height: 100%;
            background: #111; z-index: 2000; transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border-right: 3px solid var(--rasta-gold); box-shadow: 10px 0 30px rgba(0,0,0,0.8);
        }
        .sidebar.active { left: 0; }
        .sidebar-header { padding: 40px 20px; background: #000; text-align: center; border-bottom: 1px solid #222; }
        .sidebar-menu { padding: 15px 0; }
        .menu-item { 
            display: flex; align-items: center; padding: 18px 25px; color: #ccc; text-decoration: none; 
            font-size: 1rem; border-bottom: 1px solid #1a1a1a; transition: 0.3s;
        }
        .menu-item:active { background: #222; color: var(--rasta-gold); }
        .menu-icon { margin-right: 15px; font-size: 1.2rem; }
        .logout-btn { color: var(--rasta-red) !important; font-weight: bold; margin-top: 30px; border-top: 1px solid #333; }
        
        .overlay { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.8); display: none; z-index: 1500; backdrop-filter: blur(4px);
        }

        /* --- LOBBY HEADER --- */
        header { 
            background: rgba(17, 17, 17, 0.95); padding: 15px 20px; display: flex; justify-content: space-between; 
            align-items: center; border-bottom: 2px solid var(--rasta-gold); position: sticky; top: 0; z-index: 1000;
            backdrop-filter: blur(10px);
        }
        .menu-toggle { background: none; border: none; color: var(--rasta-gold); font-size: 1.8rem; cursor: pointer; padding: 0; }
        .logo-text { font-weight: 900; color: var(--rasta-gold); font-size: 1.3rem; letter-spacing: 2px; font-style: italic; }
        
        .balance-pill { 
            background: linear-gradient(to right, var(--rasta-green), #00a852); padding: 8px 16px; border-radius: 25px; 
            font-weight: bold; border: 1px solid var(--rasta-gold); cursor: pointer;
            box-shadow: 0 0 15px rgba(0, 133, 66, 0.5); font-size: 0.9rem;
            transition: transform 0.3s ease;
        }

        @keyframes balancePop {
            0% { transform: scale(1); box-shadow: 0 0 15px var(--rasta-green); }
            50% { transform: scale(1.2); box-shadow: 0 0 30px var(--rasta-gold); }
            100% { transform: scale(1); box-shadow: 0 0 15px var(--rasta-green); }
        }
        .update-flash { animation: balancePop 0.6s ease; }

        /* --- MAIN HERO BANNER --- */
        .banner { 
            height: 240px; 
            background: linear-gradient(to bottom, rgba(0,0,0,0.2), #0a0a0a), url('asset/asset.bg.jpg');
            background-size: cover; 
            background-position: center top; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: flex-end;
            padding-bottom: 20px;
            border-bottom: 4px solid var(--rasta-green); 
            position: relative;
            text-align: center;
        }
        
        .welcome-text-group {
            background: rgba(0, 0, 0, 0.7);
            padding: 10px 20px;
            border-radius: 15px;
            border: 1px solid var(--rasta-gold);
            backdrop-filter: blur(5px);
            margin-bottom: 10px;
            width: 80%;
        }

        .welcome-title {
            color: var(--rasta-gold);
            font-size: 1.2rem;
            font-weight: 900;
            margin: 0;
            text-shadow: 0 2px 5px rgba(0,0,0,0.8);
            letter-spacing: 1px;
        }

        .welcome-motto {
            color: var(--rasta-green);
            font-size: 0.8rem;
            letter-spacing: 3px;
            margin: 5px 0;
            font-weight: bold;
            text-transform: uppercase;
        }

        .player-name-display {
            color: white;
            font-size: 1rem;
            font-weight: bold;
            text-shadow: 0 1px 3px black;
        }

        /* --- WINNER TICKER --- */
        .ticker { background: #111; padding: 8px; font-size: 0.75rem; color: var(--rasta-gold); border-bottom: 1px solid #222; overflow: hidden; white-space: nowrap; }
        .ticker-text { display: inline-block; animation: scroll 30s linear infinite; }
        @keyframes scroll { from { transform: translateX(100%); } to { transform: translateX(-100%); } }

        /* --- GAME GRID --- */
        .game-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; padding: 15px; }
        .game-card { 
            background: #1a1a1a; border-radius: 20px; overflow: hidden; 
            border: 1px solid #2a2a2a; position: relative; aspect-ratio: 1/1.2; cursor: pointer;
            transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); box-shadow: var(--card-shadow);
        }
        
        .game-card.featured {
            grid-column: span 2;
            aspect-ratio: 2 / 1.1;
            border: 2px solid var(--rasta-gold);
        }

        .game-card img { width: 100%; height: 78%; object-fit: cover; transition: 0.5s; filter: brightness(0.9); }
        .game-card:hover img { transform: scale(1.1); filter: brightness(1.1); }
        .game-card:active { transform: scale(0.94); }
        
        .game-tag {
            position: absolute; top: 10px; right: 10px; background: var(--rasta-red); color: white;
            font-size: 0.65rem; font-weight: bold; padding: 4px 10px; border-radius: 6px; text-transform: uppercase;
            z-index: 5; box-shadow: 0 2px 5px rgba(0,0,0,0.5);
        }

        .game-footer { 
            position: absolute; bottom: 0; width: 100%; background: #000; 
            padding: 10px 0; text-align: center; color: white; border-top: 2px solid var(--rasta-gold);
        }
        .game-title-text { font-size: 0.75rem; font-weight: bold; letter-spacing: 1px; }

        .special-logo {
            position: absolute; top: 40%; left: 50%; transform: translate(-50%, -50%);
            border: 3px solid var(--rasta-gold);
            color: white; border-radius: 50%; width: 75px; height: 75px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            font-weight: 900; box-shadow: 0 0 20px rgba(0,0,0,0.8); z-index: 4;
            text-align: center;
        }

        .keno-logo { background: var(--rasta-red); }
        .wheel-logo { 
            background: conic-gradient(red, yellow, green, red, yellow, green); 
            animation: spin 5s linear infinite;
        }
        @keyframes spin { from { transform: translate(-50%, -50%) rotate(0deg); } to { transform: translate(-50%, -50%) rotate(360deg); } }

        .scratch-logo { background: #444; border-radius: 10px; width: 80px; height: 50px; font-size: 0.7rem; }

        /* --- VISITOR GATE --- */
        #visitor-gate {
            height: 100vh; display: none; flex-direction: column; align-items: center; justify-content: center;
            background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.9)), url('asset/asset.bg.jpg');
            background-size: cover; background-position: center; text-align: center;
        }
        .gate-logo { width: 130px; height: 130px; margin-bottom: 25px; border: 4px solid var(--rasta-gold); border-radius: 50%; box-shadow: 0 0 30px var(--rasta-gold); }
        .btn-gate { 
            display: block; width: 250px; padding: 20px; margin: 15px 0; border-radius: 45px; 
            text-decoration: none; font-weight: 900; font-size: 1.3rem; text-align: center; transition: 0.3s;
        }
        .btn-login-gate { background: var(--rasta-green); color: white; box-shadow: 0 6px 0 #004d26; }
        .btn-reg-gate { border: 2px solid var(--rasta-gold); color: var(--rasta-gold); background: rgba(0,0,0,0.6); }
        .btn-gate:active { transform: translateY(4px); box-shadow: none; }

        /* --- BOTTOM NAV --- */
        .bottom-nav { 
            position: fixed; bottom: 0; width: 100%; height: 80px; background: #000; 
            display: flex; justify-content: space-around; align-items: center; border-top: 3px solid var(--rasta-gold);
            z-index: 1000; padding-bottom: env(safe-area-inset-bottom);
        }
        .nav-link { text-decoration: none; color: #666; text-align: center; font-size: 0.75rem; font-weight: bold; transition: 0.3s; }
        .nav-link.active { color: var(--rasta-gold); text-shadow: 0 0 10px var(--rasta-gold); }
    </style>
</head>
<body>

<div class="overlay" id="menuOverlay" onclick="toggleMenu()"></div>

<div class="sidebar" id="mainSidebar">
    <div class="sidebar-header">
        <img src="asset/king.jpg" style="width:80px; border-radius:50%; border:3px solid var(--rasta-gold); margin-bottom:10px;">
        <h2 style="color:var(--rasta-gold); margin:0; letter-spacing:1px; font-size: 1.4rem;">RASTA HOUSE</h2>
        <p id="sideUserID" style="color:var(--rasta-green); font-weight:bold; font-size:0.9rem; margin-top:5px;"></p>
        <p id="sideUserPhone" style="color:#888; font-size:0.85rem; margin:8px 0 0;"></p>
    </div>
    <div class="sidebar-menu">
        <a href="index.html" class="menu-item"><span class="menu-icon">üè†</span> Lobby / ·àò·åç·â¢·ã´</a>
        <a href="profile.html" class="menu-item"><span class="menu-icon">üí∞</span> Wallet / ·ã®·ä™·àµ ·â¶·à≠·à≥</a>
        <a href="profile.html?view=withdraw" class="menu-item"><span class="menu-icon">üí∏</span> Withdraw / ·ãà·å™</a>
        <a href="profile.html?view=deposit" class="menu-item"><span class="menu-icon">‚ûï</span> Deposit / ·åà·â¢</a>
        <a href="support.html" class="menu-item"><span class="menu-icon">üéß</span> Support / ·ä•·à≠·ã≥·â≥</a>
        <a href="javascript:void(0)" class="menu-item logout-btn" onclick="handleLogout()"><span class="menu-icon">üö™</span> Logout / ·ãç·å£</a>
    </div>
</div>

<div id="visitor-gate">
    <img src="asset/king.jpg" class="gate-logo">
    <h1 style="color:var(--rasta-gold); font-size: 2.8rem; margin: 0; letter-spacing: 3px;">RASTA HOUSE</h1>
    <p style="color:var(--rasta-green); font-weight:bold; letter-spacing:5px; margin: 5px 0 40px;">ONE LOVE ‚Ä¢ WIN BIG</p>
    <div class="gate-buttons">
        <a href="login.html" class="btn-gate btn-login-gate">LOGIN</a>
        <a href="register.html" class="btn-gate btn-reg-gate">REGISTER</a>
    </div>
</div>

<div id="lobby-view" style="display:none;">
    <header>
        <button class="menu-toggle" onclick="toggleMenu()">‚ò∞</button>
        <div class="logo-text">RASTA HOUSE</div>
        <div class="balance-pill" id="balContainer" onclick="location.href='profile.html'"><span id="userBal">0.00</span> ETB</div>
    </header>

    <div class="ticker">
        <div class="ticker-text" id="winnerTicker">Loading current winners...</div>
    </div>

    <div class="banner">
        <div class="welcome-text-group">
            <h3 class="welcome-title">WELCOME RASTA HOUSE</h3>
            <div class="welcome-motto">ONE LOVE ‚Ä¢ ONE HEART</div>
            <div id="welcomeUser" class="player-name-display">LOADING PLAYER...</div>
            <div id="welcomeID" style="color:var(--rasta-gold); font-size:0.75rem; margin-top:2px;">RH-XXXX</div>
        </div>
    </div>

    <div class="game-grid">
        <div class="game-card featured" onclick="location.href='fruit.html'">
            <div class="game-tag" style="background:var(--rasta-gold); color:black; font-size:0.8rem;">NEW FEATURED</div>
            <img src="asset/fruit-master.png"> <div class="game-footer">
                <div class="game-title-text" style="font-size:0.9rem;">FRUIT BOUNCE</div>
            </div>
        </div>

        <div class="game-card" onclick="location.href='trip.html'">
            <div class="game-tag" style="background:var(--rasta-gold); color:black;">ULTRA</div>
            <img src="asset/background.fine.jpg">
            <div class="game-footer">
                <div class="game-title-text">TRIP REVELATION</div>
            </div>
        </div>

        <div class="game-card" onclick="location.href='rasta-revelation.html'">
            <div class="game-tag">CLASSIC</div>
            <img src="asset/bob.jpg">
            <div class="game-footer">
                <div class="game-title-text">RASTA REVELATION</div>
            </div>
        </div>

        <div class="game-card" onclick="location.href='zion-slots.html'">
            <div class="game-tag" style="background:var(--rasta-green);">SLOTS</div>
            <img src="asset/zion.jpg">
            <div class="game-footer">
                <div class="game-title-text">ZION SLOTS</div>
            </div>
        </div>

        <div class="game-card" onclick="location.href='lion-judah.html'">
            <div class="game-tag" style="background:var(--rasta-gold); color:black;">ROYAL</div>
            <img src="asset/lion.jpg">
            <div class="game-footer">
                <div class="game-title-text">LION OF JUDAH</div>
            </div>
        </div>

        <div class="game-card" onclick="location.href='fast-keno-80.html'">
            <div class="game-tag" style="background:var(--rasta-green);">FAST</div>
            <img src="asset/mar.jpg">
            <div class="special-logo keno-logo">
                <span style="font-size:0.7rem;">KENO</span>
                <span style="font-size:1.8rem; line-height:1;">80</span>
            </div>
            <div class="game-footer">
                <div class="game-title-text">FAST KENO 80</div>
            </div>
        </div>

        <div class="game-card" onclick="location.href='wheel.html'">
            <div class="game-tag" style="background:var(--rasta-red);">Big Win</div>
            <img src="asset/king.jpg">
            <div class="special-logo wheel-logo">
                <span style="font-size:0.6rem; color:black;">WHEEL</span>
            </div>
            <div class="game-footer">
                <div class="game-title-text">RASTA WHEEL</div>
            </div>
        </div>

        <div class="game-card" onclick="location.href='african-gold.html'">
            <div class="game-tag" style="background:var(--rasta-gold); color:black;">GOLD</div>
            <img src="asset/gold.jpg">
            <div class="game-footer">
                <div class="game-title-text">AFRICAN GOLD</div>
            </div>
        </div>

        <div class="game-card" onclick="location.href='emperor-reels.html'">
            <div class="game-tag" style="background:var(--rasta-red);">VIP</div>
            <img src="asset/emperor.jpg">
            <div class="game-footer">
                <div class="game-title-text">EMPEROR'S REELS</div>
            </div>
        </div>

        <div class="game-card" onclick="location.href='ben.html'">
            <div class="game-tag" style="background:#00ff00; color:black;">BEN 10</div>
            <img src="asset/safari.jpeg">
            <div class="game-footer">
                <div class="game-title-text">OMNITRIX LUCK</div>
            </div>
        </div>

        <div class="game-card" onclick="location.href='scratch.html'">
            <div class="game-tag">INSTANT</div><img src="asset/asset.three.jpg">
            <div class="special-logo scratch-logo">
                <span>SCRATCH</span>
            </div>
            <div class="game-footer">
                <div class="game-title-text">SCRATCH & WIN</div>
            </div>
        </div>

        <div class="game-card" onclick="location.href='premium-slots.html'">
            <div class="game-tag" style="background:var(--rasta-red);">HOT</div>
            <img src="asset/multilogo.jpeg">
            <div class="game-footer">
                <div class="game-title-text">MULTI HOT 5</div>
            </div>
        </div>

        <div class="game-card" onclick="location.href='safari-simba.html'">
            <div class="game-tag">WILD</div>
            <img src="asset/safari.jpeg">
            <div class="game-footer">
                <div class="game-title-text">SAFARI SIMBA</div>
            </div>
        </div>

        <div class="game-card" onclick="location.href='crash.html'">
            <div class="game-tag" style="background:purple;">X1000</div>
            <img src="asset/rasta.two.jpg">
            <div class="game-footer">
                <div class="game-title-text">RASTA CRASH</div>
            </div>
        </div>
    </div>

    <nav class="bottom-nav">
        <a href="index.html" class="nav-link active">üè†<br>HOME</a>
        <a href="profile.html" class="nav-link">üí∞<br>WALLET</a>
        <a href="profile.html?view=withdraw" class="nav-link">üí∏<br>CASHOUT</a>
    </nav>
</div>

<script>
    // FIXED URL: Using lowercase 'l' for alnhJtA
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyJ78n_8B2VpNsXJKWagXOTRifs4tRYjfyq8OuQ_vKUe-MUN8iTguZYe4Q2muxAlnhJtA/exec";

    function toggleMenu() {
        const sidebar = document.getElementById('mainSidebar');
        const overlay = document.getElementById('menuOverlay');
        const isActive = sidebar.classList.toggle('active');
        overlay.style.display = isActive ? 'block' : 'none';
    }

    function handleLogout() {
        if(confirm("Exit Rasta House? / ·àò·ãç·å£·âµ ·âµ·çà·àç·åã·àà·àÖ?")) {
            localStorage.removeItem('rasta_user');
            window.location.reload();
        }
    }

    async function syncBalance() {
        const userData = localStorage.getItem('rasta_user');
        if(!userData) return;
        const user = JSON.parse(userData);
        const phone = (user.phone || "").replace(/^0+/, '');

        try {
            const res = await fetch(`${SCRIPT_URL}?action=getBalance&phone=${phone}&t=${Date.now()}`);
            const data = await res.json();
            
            if(data && data.balance !== undefined) {
                const newBal = parseFloat(data.balance);
                const oldBal = parseFloat(user.balance || 0);
                
                if (Math.abs(newBal - oldBal) > 0.01) {
                    const container = document.getElementById('balContainer');
                    container.classList.remove('update-flash');
                    void container.offsetWidth; 
                    container.classList.add('update-flash');
                    
                    user.balance = newBal;
                    localStorage.setItem('rasta_user', JSON.stringify(user));
                    document.getElementById('userBal').innerText = newBal.toFixed(2);
                }
            }
        } catch(e) { console.warn("Syncing..."); }
    }

    window.onload = () => {
        const userData = localStorage.getItem('rasta_user');
        
        if(!userData) { 
            document.getElementById('visitor-gate').style.display = 'flex';
            document.getElementById('lobby-view').style.display = 'none';
        } else {
            const user = JSON.parse(userData);
            document.getElementById('visitor-gate').style.display = 'none';
            document.getElementById('lobby-view').style.display = 'block';
            
            document.getElementById('userBal').innerText = parseFloat(user.balance || 0).toFixed(2);
            document.getElementById('welcomeUser').innerText = "RESPECT, " + (user.name || "PLAYER").toUpperCase();
            document.getElementById('welcomeID').innerText = user.id || "RH-READY";
            document.getElementById('sideUserID').innerText = user.id || "RH-ID";
            document.getElementById('sideUserPhone').innerText = "PH: " + (user.phone || "");
            
            syncBalance();
            setInterval(syncBalance, 8000);
            
            const names = ["Abebe", "Selam", "Dawit", "Hanna", "Mulu", "Aster", "Yared", "Tsion", "Kassa", "Elias"];
            const gamesList = ["Trip Revelation", "Fruit Bounce", "Safari Simba", "Multi Hot", "Rasta Wheel", "Zion Slots"];
            let tickerText = "";
            for(let i=0; i<15; i++) {
                const n = names[Math.floor(Math.random()*names.length)];
                const g = gamesList[Math.floor(Math.random()*gamesList.length)];
                const w = (Math.random()*2500 + 150).toFixed(0);
                tickerText += ` ‚Ä¢ ${n} won ${w} ETB on ${g}! `;
            }
            document.getElementById('winnerTicker').innerText = tickerText + tickerText;
        }
    };
</script>
</body>
</html>
